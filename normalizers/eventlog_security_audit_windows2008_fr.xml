<?xml version="1.0" encoding="UTF-8"?>
<!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
<!--                                                            -->
<!-- pylogparser - Logs parsers python library                  -->
<!-- Copyright (C) 2012 Wallix Inc.                             -->
<!--                                                            -->
<!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
<!--                                                            -->
<!-- This package is free software; you can redistribute        -->
<!-- it and/or modify it under the terms of the GNU Lesser      -->
<!-- General Public License as published by the Free Software   -->
<!-- Foundation; either version 2.1 of the License, or (at      -->
<!-- your option) any later version.                            -->
<!--                                                            -->
<!-- This package is distributed in the hope that it will be    -->
<!-- useful, but WITHOUT ANY WARRANTY; without even the implied -->
<!-- warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR    -->
<!-- PURPOSE.  See the GNU Lesser General Public License for    -->
<!-- more details.                                              -->
<!--                                                            -->
<!-- You should have received a copy of the GNU Lesser General  -->
<!-- Public License along with this package; if not, write      -->
<!-- to the Free Software Foundation, Inc., 59 Temple Place,    -->
<!-- Suite 330, Boston, MA  02111-1307  USA                     -->
<!--                                                            -->
<!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
<!DOCTYPE normalizer SYSTEM "normalizer.dtd">
<normalizer name="EventLog-Security-Windows2008[FR]_1"
            version="0.99"
            unicode="yes"
            ignorecase="yes"
            matchtype="search"
            appliedTo="eventlog_description"
            taxonomy="access control"
            expandWhitespaces="yes">
    <description>
        <localized_desc language="en">This normalizer parses common security audit logs from the Windows 2008 Event Log, localized in English.
The following event IDs are covered: 
* 4624, 4625, 4634, 4647, 4648 (logon events),
</localized_desc>
        <localized_desc language="fr">Ce normaliseur traite les logs d'audit de sécurité communs du Journal d'événéments de Windows 2008, en version anglaise.
Les codes d'événements suivants sont normalisés :
* 4624, 4625, 4634, 4647, 4648 (événements de connexion),
</localized_desc>
    </description>
    <authors>
        <author>lbenlahmr@wallix.com</author>
    </authors>
    <callbacks>
    	<callback name="strip_values">
for t in log:
	if isinstance(log[t], basestring):
		try:
			log[t] = log[t].strip()
		except:
			pass
    	</callback>
    	<callback name="decode_logon_type">
decoder = { '2' : 'Interactive', '3' : 'Network', '4' : 'Batch', '5' : 'Service', '6' : 'Proxy', '7' : 'UnlockWorkstationLogon', '8' : 'NetworkCleartext', '9' : 'NewCredentials', '10' : 'RemoteInteractive', '11' : 'CachedInteractive' }
log['method'] = decoder.get(value, 'UNKNOWN')
        </callback>
    </callbacks>
    <patterns>
	<pattern name="eventID-4624">
            <description>
                <localized_desc language="en">Successful logon</localized_desc>
                <localized_desc language="fr">Connexion réussie</localized_desc>
            </description>   
            <text>L’ouverture de session d’un compte s’est correctement déroulée. Sujet : ID de sécurité : (?:_SID_ )?Nom du compte : (?:_ACCOUNTNAME_ )?Domaine du compte : (?:_ACCOUNTDOMAIN_ )?ID d’ouverture de session : (?:_LID_ )?Type d’ouverture de session : (?:_LOGONTYPE_ )Nouvelle ouverture de session : ID de sécurité : (?:_NLOSID_ )?Nom du compte : (?:_NACCOUNTNAME_ )?Domaine du compte : (?:_NACCOUNTDOMAIN_ )?ID d’ouverture de session : (?:_NLID_ )?GUID d’ouverture de session : (?:_NLGUID_ )?Informations sur le processus : ID du processus : (?:_PID_ )?Nom du processus : (?:_PNAME_ )?Informations sur le réseau : Nom de la station de travail : (?:_WORKSTATIONNAME_ )?Adresse du réseau source : (?:_SRCNETWORKADDR_ )?Port source : (?:_SRCPORT_ )?Informations détaillées sur l’authentification : Processus d’ouverture de session : (?:_LPROCESS_ )?Package d’authentification :	(?:_AP_ )?Services en transit : (?:_TS_ )?Nom du package \(NTLM uniquement\) : (?:_PN_ )?Longueur de la clé : (?:_KL_ )?Cet événement est généré lors de la création d’une ouverture de session. Il est généré sur l’ordinateur sur lequel l’ouverture de session a été effectuée. Le champ Objet indique le compte sur le système local qui a demandé l’ouverture de session. Il s’agit le plus souvent d’un service, comme le service Serveur, ou un processus local tel que Winlogon.exe ou Services.exe. Le champ Type d’ouverture de session indique le type d’ouverture de session qui s’est produit. Les types les plus courants sont 2 \(interactif\) et 3 \(réseau\).</text>         
            
            <tags>
            	<tag name="security_id" tagType="Anything">
                    <description>
                        <localized_desc language="en">The security ID</localized_desc>
                        <localized_desc language="fr">L'identifiant de sécurité</localized_desc>
                    </description>
                    <substitute>_SID_</substitute>
            	</tag>
            	<tag name="user" tagType="Anything">
                    <description>
                        <localized_desc language="en">Identifies the account that requested the logon - NOT the user who just logged on</localized_desc>
                        <localized_desc language="fr">Identifie le nom du compte qui a fait la requête de connexion - Pas l'utilisateur qui est déjà connecté</localized_desc>
                    </description>
                    <substitute>_ACCOUNTNAME_</substitute>
            	</tag>
            	<tag name="domain" tagType="Anything">
                    <description>
                        <localized_desc language="en">Identifies the domaine of the account that requested the logon - NOT the user who just logged on</localized_desc>
                        <localized_desc language="fr">Identifie le domaine du compte qui a fait la requête de connexion - Pas l'utilisateur qui est déjà connecté</localized_desc>
                    </description>
                    <substitute>_ACCOUNTDOMAIN_</substitute>
            	</tag>
            	<tag name="logon_id" tagType="Anything">
                    <description>
                        <localized_desc language="en">The account ID that requested the logon - NOT the user who just logged on</localized_desc>
                        <localized_desc language="fr">L'identifiant de connexion du compte qui a fait la requête de connexion - Pas l'utilisateur qui est déjà connecté </localized_desc>
                    </description>
                    <substitute>_LID_</substitute>
            	</tag>
            	<tag name="logon_type" tagType="Integer">
                    <description>
                        <localized_desc language="en">The logon type</localized_desc>
                        <localized_desc language="fr">Le type de connexion</localized_desc>
                    </description>
                    <substitute>_LOGONTYPE_</substitute>
                    <callbacks>
                 		<callback>decode_logon_type</callback>
                 	</callbacks>
            	</tag>
            	<tag name="new_logon_security_id" tagType="Anything">
                    <description>
                        <localized_desc language="en">The account security ID of the user who just logged on</localized_desc>
                        <localized_desc language="fr">L’identifiant de securité du compte de l'utilisateur qui vient juste de se connecter</localized_desc>
                    </description>
                    <substitute>_NLOSID_</substitute>
            	</tag>            	
            	<tag name="new_logon_account_name" tagType="Anything">
                    <description>
                        <localized_desc language="en">The account name of the user who just logged on</localized_desc>
                        <localized_desc language="fr">Le nom du compte de l'utilisateur qui vient juste de se connecter</localized_desc>
                    </description>
                    <substitute>_NACCOUNTNAME_</substitute>
            	</tag>
            	<tag name="new_logon_account_domain" tagType="Anything">
                    <description>
                        <localized_desc language="en">The account domaine of the user who just logged on</localized_desc>
                        <localized_desc language="fr">Le domaine du compte de l'utilisateur qui vient juste de se connecter</localized_desc>
                    </description>
                    <substitute>_NACCOUNTDOMAIN_</substitute>
            	</tag> 
            	<tag name="new_logon_id" tagType="Anything">
                    <description>
                        <localized_desc language="en">The account ID</localized_desc>
                        <localized_desc language="fr">L'identifiant de connexion</localized_desc>
                    </description>
                    <substitute>_NLID_</substitute>
            	</tag> 
            	<tag name="new_logon_guid" tagType="Anything">
                    <description>
                        <localized_desc language="en">The account GUID</localized_desc>
                        <localized_desc language="fr">Le GUID de connexion</localized_desc>
                    </description>
                    <substitute>_NLGUID_</substitute>
            	</tag>
            	<tag name="pid" tagType="Anything">
                    <description>
                        <localized_desc language="en">The caller process ID</localized_desc>
                        <localized_desc language="fr">L'identifiant de processus de l'appelant</localized_desc>
                    </description>
                    <substitute>_PID_</substitute>
            	</tag>
            	<tag name="process_name" tagType="Anything">
                    <description>
                        <localized_desc language="en">The process name that processed the logon</localized_desc>
                        <localized_desc language="fr">Le nom du programme qui provoqué la connexion</localized_desc>
                    </description>
                    <substitute>_PNAME_</substitute>
            	</tag> 
            	<tag name="workstation_name" tagType="Anything">
                    <description>
                        <localized_desc language="en">The workstation name</localized_desc>
                        <localized_desc language="fr">Le nom du poste de travail</localized_desc>
                    </description>
                    <substitute>_WORKSTATIONNAME_</substitute>
            	</tag> 
				<tag name="source_ip" tagType="Anything">
                    <description>
                        <localized_desc language="en">The logon source IP</localized_desc>
                        <localized_desc language="fr">L'IP source de la connexion</localized_desc>
                    </description>
                    <substitute>_SRCNETWORKADDR_</substitute>
            	</tag>
            	<tag name="source_port" tagType="Anything">
                    <description>
                        <localized_desc language="en">The logon source port</localized_desc>
                        <localized_desc language="fr">Le port source de la connexion</localized_desc>
                    </description>
                    <substitute>_SRCPORT_</substitute>
            	</tag>
            	<tag name="logon_process" tagType="Anything">
                    <description>
                        <localized_desc language="en">The logon process name</localized_desc>
                        <localized_desc language="fr">Le nom de programme de connexion</localized_desc>
                    </description>
                    <substitute>_LPROCESS_</substitute>
            	</tag>
            	<tag name="authentification_package" tagType="Anything">
                    <description>
                        <localized_desc language="en">The authentication package</localized_desc>
                        <localized_desc language="fr">Le package d'authentification</localized_desc>
                    </description>
                    <substitute>_AP_</substitute>
            	</tag> 
            	<tag name="transited_services" tagType="Anything">
                    <description>
                        <localized_desc language="en">The transited services</localized_desc>
                        <localized_desc language="fr">Les services en transit</localized_desc>
                    </description>
                    <substitute>_TS_</substitute>
            	</tag>
            	<tag name="package_name" tagType="Anything">
                    <description>
                        <localized_desc language="en">The package name</localized_desc>
                        <localized_desc language="fr">Le nom du package</localized_desc>
                    </description>
                    <substitute>_PN_</substitute>
            	</tag> 
            	<tag name="key_length" tagType="Anything">
                    <description>
                        <localized_desc language="en">The key length</localized_desc>
                        <localized_desc language="fr">La taille de la clé</localized_desc>
                    </description>
                    <substitute>_KL_</substitute>
            	</tag>
            </tags>
            <commonTags>
            	<commonTag name="status">success</commonTag>
            </commonTags>
            <examples>
                <example>
                	<text>L’ouverture de session d’un compte s’est correctement déroulée.

Sujet :
	ID de sécurité : SYSTEM
	Nom du compte : WIN-R9H529RIO4Y$
	Domaine du compte : WORKGROUP
	ID d’ouverture de session : 0x3e7
Type d’ouverture de session : 10
Nouvelle ouverture de session :
	ID de sécurité : WIN-R9H529RIO4Y\Administrator
	Nom du compte : Administrator
	Domaine du compte : WIN-R9H529RIO4Y
	ID d’ouverture de session :  0x19f4c
	GUID d’ouverture de session :  {00000000-0000-0000-0000-000000000000}

Informations sur le processus :
	ID du processus :  0x4c0
	Nom du processus :  C:\Windows\System32\winlogon.exe

Informations sur le réseau :
	Nom de la station de travail : WIN-R9H529RIO4Y
	Adresse du réseau source : 10.42.42.211
	Port source :  1181

Informations détaillées sur l’authentification :
	Processus d’ouverture de session :  User32
	Package d’authentification : Negotiate
	Services en transit : -
	Nom du package (NTLM uniquement) : -
	Longueur de la clé : 0

Cet événement est généré lors de la création d’une ouverture de session. 
Il est généré sur l’ordinateur sur lequel l’ouverture de session a été effectuée.
Le champ Objet indique le compte sur le système local qui a demandé l’ouverture de session. 
Il s’agit le plus souvent d’un service, comme le service Serveur, ou un processus local tel que Winlogon.exe ou Services.exe.
Le champ Type d’ouverture de session indique le type d’ouverture de session qui s’est produit. 
Les types les plus courants sont 2 (interactif) et 3 (réseau).</text>
                     <expectedTags>
                          <expectedTag name="security_id">SYSTEM</expectedTag>
                          <expectedTag name="user">WIN-R9H529RIO4Y$</expectedTag>
                          <expectedTag name="domain">WORKGROUP</expectedTag>
                          <expectedTag name="logon_id">0x3e7</expectedTag>
                          <expectedTag name="logon_type">10</expectedTag>
                          <expectedTag name="method">RemoteInteractive</expectedTag>
                          <expectedTag name="new_logon_security_id">WIN-R9H529RIO4Y\Administrator</expectedTag>
                          <expectedTag name="new_logon_account_name">Administrator</expectedTag>
                          <expectedTag name="new_logon_account_domain">WIN-R9H529RIO4Y</expectedTag>
                          <expectedTag name="new_logon_id">0x19f4c</expectedTag>
                          <expectedTag name="new_logon_guid">{00000000-0000-0000-0000-000000000000}</expectedTag>
                          <expectedTag name="pid">0x4c0</expectedTag>
                          <expectedTag name="process_name">C:\Windows\System32\winlogon.exe</expectedTag>
                          <expectedTag name="workstation_name">WIN-R9H529RIO4Y</expectedTag>
                          <expectedTag name="source_ip">10.42.42.211</expectedTag>
                          <expectedTag name="source_port">1181</expectedTag>
                          <expectedTag name="logon_process">User32</expectedTag>
                          <expectedTag name="authentification_package">Negotiate</expectedTag>
                          <expectedTag name="transited_services">-</expectedTag>
                          <expectedTag name="package_name">-</expectedTag>
                          <expectedTag name="key_length">0</expectedTag>
                          <expectedTag name="status">success</expectedTag>
                     </expectedTags>
                </example>
            </examples>
	</pattern><pattern name="eventID-4625">
            <description>
                <localized_desc language="en">Logon failure</localized_desc>
                <localized_desc language="fr">Echec de la connexion</localized_desc>
            </description> 
            <text>Échec d’ouverture de session d’un compte. Sujet : ID de sécurité : (?:_SID_ )?Nom du compte : (?:_ACCOUNTNAME_ )?Domaine du compte : (?:_ACCOUNTDOMAIN_ )?ID d’ouverture de session : (?:_LID_ )?Type d’ouverture de session : (?:_LOGONTYPE_ )?Compte pour lequel l’ouverture de session a échoué : ID de sécurité : (?:_FSID_ )?Nom du compte : (?:_FACCN_ )?Domaine du compte : (?:_FACCD_ )?Informations sur l’échec : Raison de l’échec : (?:_FREASON_ )?État : (?:_FSTATUS_ )?Sous-état : (?:_FSUBSTATUS_ )?Informations sur le processus : ID du processus de l’appelant : (?:_CPID_ )?Nom du processus de l’appelant : (?:_CPN_ )?Informations sur le réseau : Nom de la station de travail : (?:_WORKSTATIONNAME_ )?Adresse du réseau source : (?:_SRCNETWORKADDR_ )?Port source : (?:_SRCPORT_ )?Informations détaillées sur l’authentification : Processus d’ouverture de session : (?:_LPROCESS_ )?Package d’authentification : (?:_AP_ )?Services en transit : (?:_TS_ )?Nom du package \(NTLM uniquement\) : (?:_PN_ )?Longueur de clé : (?:_KL_ )?Cet événement est généré lorsqu’une demande d’ouverture de session échoue. Il est généré sur l’ordinateur sur lequel l’accès a été tenté. Le champ Objet indique le compte sur le système local qui a demandé l’ouverture de session. Il s’agit le plus souvent d’un service, comme le service Serveur, ou un processus local tel que Winlogon.exe ou Services.exe. Le champ Type d’ouverture de session indique le type d’ouverture de session qui a été demandé. Les types les plus courants sont 2 \(interactif\) et 3 \(réseau\). Les champs relatifs aux informations sur le processus indiquent quel est le compte et le processus sur le système qui ont demandé l’ouverture de session. Les champs relatifs aux informations sur le réseau indiquent la provenance de la demande d’ouverture de session distante. Le nom de la station de travail n’étant pas toujours disponible, peut rester vide dans certains cas. Les champs relatifs aux informations d’authentification fournissent des détails sur cette demande d’ouverture de session spécifique. - Les services en transit indiquent les services intermédiaires qui ont participé à cette demande d’ouverture de session. - Le nom du package indique quel a été le sous-protocole qui a été utilisé parmi les protocoles NTLM. - La longueur de la clé indique la longueur de la clé de session générée. Elle a la valeur 0 si aucune clé de session n’a été demandée.</text>         
            <tags>
            	<tag name="security_id" tagType="Anything">
                    <description>
                        <localized_desc language="en">The security ID</localized_desc>
                        <localized_desc language="fr">L'identifiant de sécurité</localized_desc>
                    </description>
                    <substitute>_SID_</substitute>
            	</tag>
            	<tag name="user" tagType="Anything">
                    <description>
                        <localized_desc language="en">Identifies the account that requested the logon - NOT the user who just logged on</localized_desc>
                        <localized_desc language="fr">Identifie le nom du compte qui a fait la requête de connexion - Pas l'utilisateur qui est déjà connecté</localized_desc>
                    </description>
                    <substitute>_ACCOUNTNAME_</substitute>
            	</tag>
            	<tag name="domain" tagType="Anything">
                    <description>
                        <localized_desc language="en">Identifies the domaine of the account that requested the logon - NOT the user who just logged on</localized_desc>
                        <localized_desc language="fr">Identifie le domaine du compte qui a fait la requête de connexion - Pas l'utilisateur qui est déjà connecté</localized_desc>
                    </description>
                    <substitute>_ACCOUNTDOMAIN_</substitute>
            	</tag>
            	<tag name="logon_id" tagType="Anything">
                    <description>
                        <localized_desc language="en">The account ID that requested the logon - NOT the user who just logged on</localized_desc>
                        <localized_desc language="fr">L'identifiant de connexion du compte qui a fait la requête de connexion - Pas l'utilisateur qui est déjà connecté </localized_desc>
                    </description>
                    <substitute>_LID_</substitute>
            	</tag>
            	<tag name="logon_type" tagType="Integer">
                    <description>
                        <localized_desc language="en">The logon type</localized_desc>
                        <localized_desc language="fr">Le type de connexion</localized_desc>
                    </description>
                    <substitute>_LOGONTYPE_</substitute>
                    <callbacks>
                 		<callback>decode_logon_type</callback>
                 	</callbacks>
            	</tag>
            	<tag name="failed_security_id" tagType="Anything">
                    <description>
                        <localized_desc language="en">The account security ID for which Llogon failed</localized_desc>
                        <localized_desc language="fr">L'identifiant de securité du compte pour lequel la connexion a échoué</localized_desc>
                    </description>
                    <substitute>_FSID_</substitute>
            	</tag>            	
            	<tag name="failed_account_name" tagType="Anything">
                    <description>
                        <localized_desc language="en">The account name for which logon failed</localized_desc>
                        <localized_desc language="fr">Le nom du compte pour lequel la connexion a échoué</localized_desc>
                    </description>
                    <substitute>_FACCN_</substitute>
            	</tag>
            	<tag name="failed_account_domain" tagType="Anything">
                    <description>
                        <localized_desc language="en">The account domaine for which logon failed</localized_desc>
                        <localized_desc language="fr">Le domaine du compte pour lequel la connexion a échoué</localized_desc>
                    </description>
                    <substitute>_FACCD_</substitute>
            	</tag> 
            	
            	
            	<tag name="failure_reason" tagType="Anything">
                    <description>
                        <localized_desc language="en">The failure reason</localized_desc>
                        <localized_desc language="fr">La raison de l'échec</localized_desc>
                    </description>
                    <substitute>_FREASON_</substitute>
            	</tag> 
            	<tag name="failure_status" tagType="Anything">
                    <description>
                        <localized_desc language="en">The failure status</localized_desc>
                        <localized_desc language="fr">Le status de l'échec de connexion</localized_desc>
                    </description>
                    <substitute>_FSTATUS_</substitute>
            	</tag>
            	<tag name="failure_sub_status" tagType="Anything">
                    <description>
                        <localized_desc language="en">The failure sub_status"</localized_desc>
                        <localized_desc language="fr">Le sous-status de l'échec de connexion</localized_desc>
                    </description>
                    <substitute>_FSUBSTATUS_</substitute>
            	</tag>
            	
            	<tag name="caller_pid" tagType="Anything">
                    <description>
                        <localized_desc language="en">The caller process ID</localized_desc>
                        <localized_desc language="fr">L'identifiant de processus de l'appelant</localized_desc>
                    </description>
                    <substitute>_CPID_</substitute>
            	</tag>
            	
            	<tag name="caller_process_name" tagType="Anything">
                    <description>
                        <localized_desc language="en">The caller process name</localized_desc>
                        <localized_desc language="fr">Le nom du processus de l'appelant</localized_desc>
                    </description>
                    <substitute>_CPN_</substitute>
            	</tag> 
				<tag name="workstation_name" tagType="Anything">
                    <description>
                        <localized_desc language="en">The workstation name</localized_desc>
                        <localized_desc language="fr">Le nom du poste de travail</localized_desc>
                    </description>
                    <substitute>_WORKSTATIONNAME_</substitute>
            	</tag> 
				<tag name="source_ip" tagType="Anything">
                    <description>
                        <localized_desc language="en">The logon source IP</localized_desc>
                        <localized_desc language="fr">L'IP source de la connexion</localized_desc>
                    </description>
                    <substitute>_SRCNETWORKADDR_</substitute>
            	</tag>
            	<tag name="source_port" tagType="Anything">
                    <description>
                        <localized_desc language="en">The logon source port</localized_desc>
                        <localized_desc language="fr">Le port source de la connexion</localized_desc>
                    </description>
                    <substitute>_SRCPORT_</substitute>
            	</tag>
            	<tag name="logon_process" tagType="Anything">
                    <description>
                        <localized_desc language="en">The logon process name</localized_desc>
                        <localized_desc language="fr">Le nom de programme de connexion</localized_desc>
                    </description>
              		<substitute>_LPROCESS_</substitute>
            	</tag>
              	
              	<tag name="logon_type" tagType="Integer">
                    <description>
                        <localized_desc language="en">The logon type</localized_desc>
                        <localized_desc language="fr">Le type de connexion</localized_desc>
                    </description>
                    <substitute>_LOGONTYPE_</substitute>
                    <callbacks>
                 		<callback>decode_logon_type</callback>
                 	</callbacks>
            	</tag>
                    
            	<tag name="authentification_package" tagType="Anything">
                    <description>
                        <localized_desc language="en">The authentication package</localized_desc>
                        <localized_desc language="fr">Le package d'authentification</localized_desc>
                    </description>
                    <substitute>_AP_</substitute>
            	</tag> 
            	<tag name="transited_services" tagType="Anything">
                    <description>
                        <localized_desc language="en">The transited services</localized_desc>
                        <localized_desc language="fr">Les services en transit</localized_desc>
                    </description>
                    <substitute>_TS_</substitute>
            	</tag>
            	<tag name="package_name" tagType="Anything">
                    <description>
                        <localized_desc language="en">The package name</localized_desc>
                        <localized_desc language="fr">Le nom du package</localized_desc>
                    </description>
                    <substitute>_PN_</substitute>
            	</tag> 
            	<tag name="key_length" tagType="Anything">
                    <description>
                        <localized_desc language="en">The key length</localized_desc>
                        <localized_desc language="fr">La taille de la clé</localized_desc>
                    </description>
                    <substitute>_KL_</substitute>
            	</tag>
            </tags>
            <commonTags>
            	<commonTag name="status">failure</commonTag>
            </commonTags>
            <examples>
                <example>
                	 <text>Échec d’ouverture de session d’un compte.
                	           	 
Sujet :
	ID de sécurité : NULL SID
	Nom du compte : -
	Domaine du compte : -
	ID d’ouverture de session : 0x0
Type d’ouverture de session : 3
Compte pour lequel l’ouverture de session a échoué :
	ID de sécurité : NULL SID
	Nom du compte : asdf
	Domaine du compte : -
Informations sur l’échec :
	Raison de l’échec : Unknown user name or bad password.
	État : 0xc000006d
	Sous-état : 0xc0000064
Informations sur le processus :
	ID du processus de l’appelant : 0x0
	Nom du processus de l’appelant : -
Informations sur le réseau :
	Nom de la station de travail : WIN-R9H529RIO4Y
	Adresse du réseau source : 10.42.42.201
	Port source : 53176
Informations détaillées sur l’authentification :
 	Processus d’ouverture de session : NtLmSsp
 	Package d’authentification : NTLM
 	Services en transit : -
 	Nom du package (NTLM uniquement) : -
 	Longueur de clé : 0
 	
Cet événement est généré lorsqu’une demande d’ouverture de session échoue. 
Il est généré sur l’ordinateur sur lequel l’accès a été tenté.
Le champ Objet indique le compte sur le système local qui a demandé l’ouverture de session. 
Il s’agit le plus souvent d’un service, comme le service Serveur, ou un processus local tel que Winlogon.exe ou Services.exe.
Le champ Type d’ouverture de session indique le type d’ouverture de session qui a été demandé. 
Les types les plus courants sont 2 (interactif) et 3 (réseau).
Les champs relatifs aux informations sur le processus indiquent quel est le compte et le processus sur le système qui ont demandé l’ouverture de session.
Les champs relatifs aux informations sur le réseau indiquent la provenance de la demande d’ouverture de session distante. 
Le nom de la station de travail n’étant pas toujours disponible, peut rester vide dans certains cas.
Les champs relatifs aux informations d’authentification fournissent des détails sur cette demande d’ouverture de session spécifique.
	- Les services en transit indiquent les services intermédiaires qui ont participé à cette demande d’ouverture de session.
	- Le nom du package indique quel a été le sous-protocole qui a été utilisé parmi les protocoles NTLM.
	- La longueur de la clé indique la longueur de la clé de session générée. Elle a la valeur 0 si aucune clé de session n’a été demandée.</text>
                          <expectedTags>
                          <expectedTag name="security_id">NULL SID</expectedTag>
                          <expectedTag name="user">-</expectedTag>
                          <expectedTag name="domain">-</expectedTag>
                          <expectedTag name="logon_id">0x0</expectedTag>
                          <expectedTag name="logon_type">3</expectedTag>
                          <expectedTag name="method">Network</expectedTag>                   
                          <expectedTag name="failed_security_id">NULL SID</expectedTag>
                          <expectedTag name="failed_account_name">asdf</expectedTag>
                          <expectedTag name="failed_account_domain">-</expectedTag>
                          <expectedTag name="failure_reason">Unknown user name or bad password.</expectedTag>
                          <expectedTag name="failure_status">0xc000006d</expectedTag>
                          <expectedTag name="failure_sub_status">0xc0000064</expectedTag>
                          <expectedTag name="caller_pid">0x0</expectedTag>
                          <expectedTag name="caller_process_name">-</expectedTag>
                          <expectedTag name="workstation_name">WIN-R9H529RIO4Y</expectedTag>
                          <expectedTag name="source_ip">10.42.42.201</expectedTag>
                          <expectedTag name="source_port">53176</expectedTag>
                          <expectedTag name="logon_process">NtLmSsp</expectedTag>
                          <expectedTag name="authentification_package">NTLM</expectedTag>
                          <expectedTag name="transited_services">-</expectedTag>
                          <expectedTag name="package_name">-</expectedTag>
                          <expectedTag name="key_length">0</expectedTag>
                          <expectedTag name="status">failure</expectedTag>
                     </expectedTags>
                </example>
            </examples>
		</pattern><pattern name="eventID-4634">
			<description>
                <localized_desc language="en">User Logoff</localized_desc>
                <localized_desc language="fr">Déconnexion utilisateur</localized_desc>
            </description>
            <text>Fermeture de session d’un compte. Sujet : ID de sécurité : (?:_SID_ )?Nom du compte : (?:_ACCOUNTNAME_ )?Domaine du compte : (?:_ACCOUNTDOMAIN_ )?ID du compte : (?:_LID_ )?Type d’ouverture de session : (?:_LOGONTYPE_ )?Cet événement est généré lorsqu’une session ouverte est supprimée. Il peut être associé à un événement d’ouverture de session en utilisant la valeur ID d’ouverture de session. Les ID d’ouverture de session ne sont uniques qu’entre les redémarrages sur un même ordinateur.</text>
			<tags>
				<tag name="security_id" tagType="Anything">
                    <description>
                        <localized_desc language="en">The security ID</localized_desc>
                        <localized_desc language="fr">L'identifiant de sécurité</localized_desc>
                    </description>
                    <substitute>_SID_</substitute>
            	</tag>
            	<tag name="user" tagType="Anything">
                    <description>
                        <localized_desc language="en">Identifies the account that requested the logon</localized_desc>
                        <localized_desc language="fr">Identifie le nom du compte qui a fait la requête de connexion</localized_desc>
                    </description>
                    <substitute>_ACCOUNTNAME_</substitute>
            	</tag>
            	<tag name="domain" tagType="Anything">
                    <description>
                        <localized_desc language="en">Identifies the domaine of the account that requested the logon</localized_desc>
                        <localized_desc language="fr">Identifie le domaine du compte qui a fait la requête de connexion</localized_desc>
                    </description>
                    <substitute>_ACCOUNTDOMAIN_</substitute>
            	</tag>
            	<tag name="logon_id" tagType="Anything">
                    <description>
                        <localized_desc language="en">The account ID that requested the logon</localized_desc>
                        <localized_desc language="fr">L'identifiant de connexion du compte qui a fait la requête de connexion</localized_desc>
                    </description>
                    <substitute>_LID_</substitute>
            	</tag>
            	<tag name="logon_type" tagType="Integer">
                    <description>
                        <localized_desc language="en">The logon type</localized_desc>
                        <localized_desc language="fr">Le type de connexion</localized_desc>
                    </description>
                    <substitute>_LOGONTYPE_</substitute>
                    <callbacks>
                 		<callback>decode_logon_type</callback>
                 	</callbacks>
            	</tag>
			</tags>
			<examples>
				<example>
					<text>Fermeture de session d’un compte. 
Sujet :
	ID de sécurité : ANONYMOUS LOGON
	Nom du compte : ANONYMOUS LOGON
	Domaine du compte : NT AUTHORITY
	ID du compte : 0x149be

Type d’ouverture de session : 3

Cet événement est généré lorsqu’une session ouverte est supprimée.
Il peut être associé à un événement d’ouverture de session en utilisant la valeur ID d’ouverture de session. 
Les ID d’ouverture de session ne sont uniques qu’entre les redémarrages sur un même ordinateur.</text>
					<expectedTags>
						<expectedTag name="security_id">ANONYMOUS LOGON</expectedTag>
						<expectedTag name="user">ANONYMOUS LOGON</expectedTag>
						<expectedTag name="domain">NT AUTHORITY</expectedTag>
						<expectedTag name="logon_id">0x149be</expectedTag>
						<expectedTag name="logon_type">3</expectedTag>
					</expectedTags>
				</example>
			</examples>
		</pattern><pattern name="eventID-4647">
			<description>
				<localized_desc language="en">User initiated logoff</localized_desc>
				<localized_desc language="fr">L'utilisateur a initié une déconnexion</localized_desc>
			</description>
			<text>Fermeture de session initiée par l’utilisateur : Sujet : ID de sécurité : (?:_SID_ )Nom du compte : (?:_ACCOUNTNAME_ )?Domaine du compte : (?:_ACCOUNTDOMAIN_ )?ID d’ouverture de session : (?:_LID_ )?Cet événement est généré lorsqu’une fermeture de session est initiée, mais que le nombre de références du jeton n’étant pas zéro, la session ouverte ne peut pas être supprimée. Aucune autre activité initiée par l’utilisateur ne peut se produire. Cet événement peut être interprété comme un événement de fermeture de session.</text>
			<tags>
				<tag name="security_id" tagType="Anything">
                    <description>
                        <localized_desc language="en">The security ID</localized_desc>
                        <localized_desc language="fr">L'identifiant de sécurité</localized_desc>
                    </description>
                    <substitute>_SID_</substitute>
            	</tag>
            	<tag name="user" tagType="Anything">
                    <description>
                        <localized_desc language="en">Identifies the account that requested the logon</localized_desc>
                        <localized_desc language="fr">Identifie le nom du compte qui a fait la requête de connexion</localized_desc>
                    </description>
                    <substitute>_ACCOUNTNAME_</substitute>
            	</tag>
            	<tag name="domain" tagType="Anything">
                    <description>
                        <localized_desc language="en">Identifies the domaine of the account that requested the logon</localized_desc>
                        <localized_desc language="fr">Identifie le domaine du compte qui a fait la requête de connexion</localized_desc>
                    </description>
                    <substitute>_ACCOUNTDOMAIN_</substitute>
            	</tag>
            	<tag name="logon_id" tagType="Anything">
                    <description>
                        <localized_desc language="en">The account ID that requested the logon</localized_desc>
                        <localized_desc language="fr">L'identifiant de connexion du compte qui a fait la requête de connexion</localized_desc>
                    </description>
                    <substitute>_LID_</substitute>
            	</tag>
			</tags>
			<examples>
				<example>
					<text>Fermeture de session initiée par l’utilisateur :

Sujet :
	ID de sécurité : WIN-R9H529RIO4Y\Administrator
	Nom du compte : Administrator
	Domaine du compte : WIN-R9H529RIO4Y
	ID d’ouverture de session : 0x19f4c
	
Cet événement est généré lorsqu’une fermeture de session est initiée, 
mais que le nombre de références du jeton n’étant pas zéro, 
la session ouverte ne peut pas être supprimée. 
Aucune autre activité initiée par l’utilisateur ne peut se produire.
Cet événement peut être interprété comme un événement de fermeture de session.</text>
					<expectedTags>
						<expectedTag name="security_id">WIN-R9H529RIO4Y\Administrator</expectedTag>
						<expectedTag name="user">Administrator</expectedTag>
						<expectedTag name="domain">WIN-R9H529RIO4Y</expectedTag>
						<expectedTag name="logon_id">0x19f4c</expectedTag>
					</expectedTags>
				</example>
				<example>
				<text>Fermeture de session initiée par l’utilisateur :

Sujet :
	ID de sécurité : S-1-5-21-2218251928-2375033965-419438225-500
	Nom du compte : Administrator
	Domaine du compte : WIN-D7NM05T4KNM
	ID d’ouverture de session : 0xa2a99
	
Cet événement est généré lorsqu’une fermeture de session est initiée, 
mais que le nombre de références du jeton n’étant pas zéro, 
la session ouverte ne peut pas être supprimée. 
Aucune autre activité initiée par l’utilisateur ne peut se produire.
Cet événement peut être interprété comme un événement de fermeture de session.</text>
					<expectedTags>
						<expectedTag name="security_id">S-1-5-21-2218251928-2375033965-419438225-500</expectedTag>
						<expectedTag name="user">Administrator</expectedTag>
						<expectedTag name="domain">WIN-D7NM05T4KNM</expectedTag>
						<expectedTag name="logon_id">0xa2a99</expectedTag>
					</expectedTags>
				</example>
			</examples>
		</pattern><pattern name="eventID-4648">
            <description>
                <localized_desc language="en">Logon failure</localized_desc>
                <localized_desc language="fr">Echec de la connexion</localized_desc>
            </description>            
            <text>Tentative d’ouverture de session en utilisant des informations d’identification explicites. Sujet : ID de sécurité : (?:_SID_ )?Nom du compte : (?:_ACCOUNTNAME_ )?Domaine du compte : (?:_ACCOUNTDOMAIN_ )?ID d’ouverture de session : (?:_LID_ )?GUID d’ouverture de session : (?:_LGUID_ )?Compte dont les informations d’identification ont été utilisées : Nom du compte : (?:_CACCOUNTNAME_ )?Domaine du compte : (?:_CACCOUNTDOMAINE_ )?GUID d’ouverture de session : (?:_CLOGUID_ )?Serveur cible : Nom du serveur cible : (?:_TSERVERNAME_ )?Informations supplémentaires : (?:_ADDINFO_ )?Informations sur le processus : ID du processus : (?:_PID_ )?Nom du processus : (?:_PNAME_ )?Informations sur le réseau : Adresse du réseau : (?:_NETWORKADDR_ )?Port : (?:_PORT_ )?Cet événement est généré lorsqu’un processus tente d’ouvrir une session pour un compte en spécifiant explicitement les informations d’identification de ce compte. Ceci se produit le plus souvent dans les configurations par lot comme les tâches planifiées, ou avec l’utilisation de la commande RUNAS.</text>
            <tags>
            	<tag name="security_id" tagType="Anything">
                    <description>
                        <localized_desc language="en">The security ID</localized_desc>
                        <localized_desc language="fr">L'identifiant de sécurité</localized_desc>
                    </description>
                    <substitute>_SID_</substitute>
            	</tag>
            	<tag name="user" tagType="Anything">
                    <description>
                        <localized_desc language="en">Identifies the account that requested the logon</localized_desc>
                        <localized_desc language="fr">Identifie le nom du compte qui a fait la requête de connexion</localized_desc>
                    </description>
                    <substitute>_ACCOUNTNAME_</substitute>
            	</tag>
            	<tag name="domain" tagType="Anything">
                    <description>
                        <localized_desc language="en">Identifies the domaine of the account that requested the logon</localized_desc>
                        <localized_desc language="fr">Identifie le domaine du compte qui a fait la requête de connexion</localized_desc>
                    </description>
                    <substitute>_ACCOUNTDOMAIN_</substitute>
            	</tag>
            	<tag name="logon_id" tagType="Anything">
                    <description>
                        <localized_desc language="en">The account ID that requested the logon</localized_desc>
                        <localized_desc language="fr">L'identifiant de connexion du compte qui a fait la requête de connexion</localized_desc>
                    </description>
                    <substitute>_LID_</substitute>
            	</tag>
            	<tag name="logon_guid" tagType="Anything">
                    <description>
                        <localized_desc language="en">The account GUID that requested the logon - NOT the user who just logged on</localized_desc>
                        <localized_desc language="fr">L'identifiant GUID de connexion du compte qui a fait la requête de connexion</localized_desc>
                    </description>
                    <substitute>_LGUID_</substitute>
            	</tag>
            	<tag name="credentials_account_name" tagType="Anything">
                    <description>
                        <localized_desc language="en">The Account name whose credentials were used</localized_desc>
                        <localized_desc language="fr">Le nom du compte dont les informations d'identification de connexion ont été utilisés</localized_desc>
                    </description>
                    <substitute>_CACCOUNTNAME_</substitute>
            	</tag>
            	<tag name="credentials_account_domain" tagType="Anything">
                    <description>
                        <localized_desc language="en">The account domaine whose credentials were used</localized_desc>
                        <localized_desc language="fr">Le domaine du compte dont les informations d'identification de connexion ont été utilisés</localized_desc>
                    </description>
                    <substitute>_CACCOUNTDOMAINE_</substitute>
            	</tag> 
            	<tag name="credentials_logon_guid" tagType="Anything">
                    <description>
                        <localized_desc language="en">The credentials logon GUID</localized_desc>
                        <localized_desc language="fr">L'identifiant GUID du compte dont les informations d'identification de connexion ont été utilisés</localized_desc>
                    </description>
                    <substitute>_CLOGUID_</substitute>
            	</tag> 
            	<tag name="target_server_name" tagType="Anything">
                    <description>
                        <localized_desc language="en">The target server name</localized_desc>
                        <localized_desc language="fr">Le nom du serveur cible</localized_desc>
                    </description>
                    <substitute>_TSERVERNAME_</substitute>
            	</tag>
            	<tag name="additional_information" tagType="Anything">
                    <description>
                        <localized_desc language="en">Addictional information</localized_desc>
                        <localized_desc language="fr">Information supplémentaire</localized_desc>
                    </description>
                    <substitute>_ADDINFO_</substitute>
            	</tag>
            	<tag name="pid" tagType="Anything">
                    <description>
                        <localized_desc language="en">The  process ID</localized_desc>
                        <localized_desc language="fr">L'identifiant du processus</localized_desc>
                    </description>
                    <substitute>_PID_</substitute>
            	</tag>
            	<tag name="process_name" tagType="Anything">
                    <description>
                        <localized_desc language="en">The  process name</localized_desc>
                        <localized_desc language="fr">Le nom du processus</localized_desc>
                    </description>
                    <substitute>_PNAME_</substitute>
            	</tag>
            	 
				<tag name="address" tagType="Anything">
                    <description>
                        <localized_desc language="en">The logon source address</localized_desc>
                        <localized_desc language="fr">L'adresse de connexion</localized_desc>
                    </description>
                    <substitute>_NETWORKADDR_</substitute>
            	</tag> 
				<tag name="port" tagType="Anything">
                    <description>
                        <localized_desc language="en">The logon source port</localized_desc>
                        <localized_desc language="fr">Le port de connexion</localized_desc>
                    </description>
                    <substitute>_PORT_</substitute>
            	</tag>
            </tags>
            <commonTags>
            	<commonTag name="status">failure</commonTag>
            </commonTags>
            <examples>
                <example>
                	 <text>Tentative d’ouverture de session en utilisant des informations d’identification explicites.
Sujet :
	ID de sécurité : WIN-R9H529RIO4Y\Administrator
	Nom du compte : Administrator
	Domaine du compte : WIN-R9H529RIO4Y
	ID d’ouverture de session : 0x1ba0e
	GUID d’ouverture de session : {00000000-0000-0000-0000-000000000000}
	
Compte dont les informations d’identification ont été utilisées :
	Nom du compte : rsmith@mtg.com
	Domaine du compte : WIN-R9H529RIO4Y
	GUID d’ouverture de session : {00000000-0000-0000-0000-000000000000}
	
Serveur cible :
	Nom du serveur cible : sp01.IceMAIL.com
	Informations supplémentaires : sp01.IceMAIL.com
	
Informations sur le processus :
	ID du processus : 0x77c
	Nom du processus : C:\Program Files\Internet Explorer\iexplore.exe
	
Informations sur le réseau :
	Adresse du réseau : -
	Port : -
	
Cet événement est généré lorsqu’un processus tente d’ouvrir une session pour un compte en spécifiant
 explicitement les informations d’identification de ce compte. 
Ceci se produit le plus souvent dans les configurations par lot comme les tâches planifiées, 
ou avec l’utilisation de la commande RUNAS.</text>
                     <expectedTags>
                          <expectedTag name="security_id">WIN-R9H529RIO4Y\Administrator</expectedTag>
                          <expectedTag name="user">Administrator</expectedTag>
                          <expectedTag name="domain">WIN-R9H529RIO4Y</expectedTag>
                          <expectedTag name="logon_id">0x1ba0e</expectedTag>
                          <expectedTag name="logon_guid">{00000000-0000-0000-0000-000000000000}</expectedTag>
                          <expectedTag name="credentials_account_name">rsmith@mtg.com</expectedTag>                   
                          <expectedTag name="credentials_account_domain">WIN-R9H529RIO4Y</expectedTag>
                          <expectedTag name="credentials_logon_guid">{00000000-0000-0000-0000-000000000000}</expectedTag>
                          <expectedTag name="target_server_name">sp01.IceMAIL.com</expectedTag>
                          <expectedTag name="additional_information">sp01.IceMAIL.com</expectedTag>
                          <expectedTag name="pid">0x77c</expectedTag>
                          <expectedTag name="process_name">C:\Program Files\Internet Explorer\iexplore.exe</expectedTag>
                          <expectedTag name="address">-</expectedTag>
                          <expectedTag name="port">-</expectedTag>
                          <expectedTag name="status">failure</expectedTag>
                     </expectedTags>
                </example>                	
            </examples>
		</pattern>
    </patterns>
    <finalCallbacks>
    	<callback>strip_values</callback>
    </finalCallbacks>
</normalizer>

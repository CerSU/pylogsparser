<?xml version="1.0" encoding="UTF-8"?>
<!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
<!--                                                            -->
<!-- pylogparser - Logs parsers python library                  -->
<!-- Copyright (C) 2012 Wallix Inc.                             -->
<!--                                                            -->
<!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
<!--                                                            -->
<!-- This package is free software; you can redistribute        -->
<!-- it and/or modify it under the terms of the GNU Lesser      -->
<!-- General Public License as published by the Free Software   -->
<!-- Foundation; either version 2.1 of the License, or (at      -->
<!-- your option) any later version.                            -->
<!--                                                            -->
<!-- This package is distributed in the hope that it will be    -->
<!-- useful, but WITHOUT ANY WARRANTY; without even the implied -->
<!-- warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR    -->
<!-- PURPOSE.  See the GNU Lesser General Public License for    -->
<!-- more details.                                              -->
<!--                                                            -->
<!-- You should have received a copy of the GNU Lesser General  -->
<!-- Public License along with this package; if not, write      -->
<!-- to the Free Software Foundation, Inc., 59 Temple Place,    -->
<!-- Suite 330, Boston, MA  02111-1307  USA                     -->
<!--                                                            -->
<!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
<!DOCTYPE normalizer SYSTEM "normalizer.dtd">
<normalizer name="EventLog-Security-Windows2008[EN]_1"
            version="0.99"
            unicode="yes"
            ignorecase="yes"
            matchtype="search"
            appliedTo="eventlog_description"
            taxonomy="access control"
            expandWhitespaces="yes">
    <description>
        <localized_desc language="en">This normalizer parses common security audit logs from the Windows 2008 Event Log, localized in English.
The following event IDs are covered: 
* 4624, 4625, 4634, 4647, 4648 (logon events),
</localized_desc>
        <localized_desc language="fr">Ce normaliseur traite les logs d'audit de sécurité communs du Journal d'Événéments de Windows 2008, en version anglaise.
Les codes d'événements suivants sont normalisés :
* 4624, 4625, 4634, 4647, 4648 (événements de connexion),
</localized_desc>
    </description>
    <authors>
        <author>lbenlahmr@wallix.com</author>
    </authors>
    <callbacks>
    	<callback name="strip_values">
for t in log:
	if isinstance(log[t], basestring):
		try:
			log[t] = log[t].strip()
		except:
			pass
    	</callback>
    	<callback name="decode_logon_type">
decoder = { '2' : 'Interactive', '3' : 'Network', '4' : 'Batch', '5' : 'Service', '6' : 'Proxy', '7' : 'UnlockWorkstationLogon', '8' : 'NetworkCleartext', '9' : 'NewCredentials', '10' : 'RemoteInteractive', '11' : 'CachedInteractive' }
log['method'] = decoder.get(value, 'UNKNOWN')
        </callback>
    </callbacks>
    <patterns>
	<pattern name="eventID-4624">
            <description>
                <localized_desc language="en">Successful logon</localized_desc>
                <localized_desc language="fr">Connexion réussie</localized_desc>
            </description>            
            <text>An account was successfully logged on. Subject: Security ID: _SID_ Account Name: _ACCOUNTNAME_ Account Domain: _ACCOUNTDOMAIN_ Logon ID: _LID_ Logon Type: _LOGONTYPE_ New Logon: Security ID: _NLOSID_ Account Name: _NACCOUNTNAME_ Account Domain: _NACCOUNTDOMAIN_ Logon ID: _NLID_ Logon GUID: _NLGUID_ Process Information: Process ID: _PID_ Process Name: _PNAME_ Network Information: Workstation Name: _WORKSTATIONNAME_ Source Network Address: _SRCNETWORKADDR_ Source Port: _SRCPORT_ Detailed Authentication Information: Logon Process: _LPROCESS_ Authentication Package: _AP_ Transited Services: _TS_ Package Name \(NTLM only\): _PN_ Key Length: _KL_ This event is generated when a logon session is created. It is generated on the computer that was accessed. The subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe. The logon type field indicates the kind of logon that occurred. The most common types are 2 \(interactive\) and 3 \(network\). The New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on. The network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases. The authentication information fields provide detailed information about this specific logon request. - Logon GUID is a unique identifier that can be used to correlate this event with a KDC event. - Transited services indicate which intermediate services have participated in this logon request. - Package name indicates which sub-protocol was used among the NTLM protocols. - Key length indicates the length of the generated session key. This will be 0 if no session key was requested.</text>
            <tags>
            	<tag name="security_id" tagType="Anything">
                    <description>
                        <localized_desc language="en">The security ID</localized_desc>
                        <localized_desc language="fr">L'identifiant de sécurité</localized_desc>
                    </description>
                    <substitute>_SID_</substitute>
            	</tag>
            	<tag name="account_name" tagType="Anything">
                    <description>
                        <localized_desc language="en">Identifies the account that requested the logon - NOT the user who just logged on</localized_desc>
                        <localized_desc language="fr">Identifie le nom du compte qui a fait la requête de connexion - Pas l'utilisateur qui est déjà connecté</localized_desc>
                    </description>
                    <substitute>_ACCOUNTNAME_</substitute>
            	</tag>
            	<tag name="account_domaine" tagType="Anything">
                    <description>
                        <localized_desc language="en">Identifies the domaine of the account that requested the logon - NOT the user who just logged on</localized_desc>
                        <localized_desc language="fr">Identifie le domaine du compte qui a fait la requête de connexion - Pas l'utilisateur qui est déjà connecté</localized_desc>
                    </description>
                    <substitute>_ACCOUNTDOMAIN_</substitute>
            	</tag>
            	<tag name="logon_id" tagType="Anything">
                    <description>
                        <localized_desc language="en">The account ID that requested the logon - NOT the user who just logged on</localized_desc>
                        <localized_desc language="fr">L'identifiant de connexion du compte qui a fait la requête de connexion - Pas l'utilisateur qui est déjà connecté </localized_desc>
                    </description>
                    <substitute>_LID_</substitute>
            	</tag>
            	<tag name="logon_type" tagType="Integer">
                    <description>
                        <localized_desc language="en">The logon type</localized_desc>
                        <localized_desc language="fr">Le type de connexion</localized_desc>
                    </description>
                    <substitute>_LOGONTYPE_</substitute>
                    <callbacks>
                 		<callback>decode_logon_type</callback>
                 	</callbacks>
            	</tag>
            	<tag name="new_logon_security_id" tagType="Anything">
                    <description>
                        <localized_desc language="en">The account security ID of the user who just logged on</localized_desc>
                        <localized_desc language="fr">L'identifiant de securité du compte de l'utilisateur qui vient juste de se connecter</localized_desc>
                    </description>
                    <substitute>_NLOSID_</substitute>
            	</tag>            	
            	<tag name="new_logon_account_name" tagType="Anything">
                    <description>
                        <localized_desc language="en">The account name of the user who just logged on</localized_desc>
                        <localized_desc language="fr">Le nom du compte de l'utilisateur qui vient juste de se connecter</localized_desc>
                    </description>
                    <substitute>_NACCOUNTNAME_</substitute>
            	</tag>
            	<tag name="new_logon_account_domain" tagType="Anything">
                    <description>
                        <localized_desc language="en">The account domaine of the user who just logged on</localized_desc>
                        <localized_desc language="fr">Le domaine du compte de l'utilisateur qui vient juste de se connecter</localized_desc>
                    </description>
                    <substitute>_NACCOUNTDOMAIN_</substitute>
            	</tag> 
            	<tag name="new_logon_id" tagType="Anything">
                    <description>
                        <localized_desc language="en">The account ID</localized_desc>
                        <localized_desc language="fr">L'identifiant de connexion</localized_desc>
                    </description>
                    <substitute>_NLID_</substitute>
            	</tag> 
            	<tag name="new_logon_guid" tagType="Anything">
                    <description>
                        <localized_desc language="en">The account GUID</localized_desc>
                        <localized_desc language="fr">Le GUID de connexion</localized_desc>
                    </description>
                    <substitute>_NLGUID_</substitute>
            	</tag>
            	<tag name="pid" tagType="Anything">
                    <description>
                        <localized_desc language="en">The caller process ID</localized_desc>
                        <localized_desc language="fr">L'identifiant de processus de l'appelant</localized_desc>
                    </description>
                    <substitute>_PID_</substitute>
            	</tag>
            	<tag name="process_name" tagType="Anything">
                    <description>
                        <localized_desc language="en">The process name that processed the logon</localized_desc>
                        <localized_desc language="fr">Le nom du programme qui provoqué la connexion</localized_desc>
                    </description>
                    <substitute>_PNAME_</substitute>
            	</tag> 
            	<tag name="workstation_name" tagType="Anything">
                    <description>
                        <localized_desc language="en">The workstation name</localized_desc>
                        <localized_desc language="fr">Le nom du poste de travail</localized_desc>
                    </description>
                    <substitute>_WORKSTATIONNAME_</substitute>
            	</tag> 
				<tag name="source_ip" tagType="Anything">
                    <description>
                        <localized_desc language="en">The logon source IP</localized_desc>
                        <localized_desc language="fr">L'IP source de la connexion</localized_desc>
                    </description>
                    <substitute>_SRCNETWORKADDR_</substitute>
            	</tag>
            	<tag name="source_port" tagType="Anything">
                    <description>
                        <localized_desc language="en">The logon source port</localized_desc>
                        <localized_desc language="fr">Le port source de la connexion</localized_desc>
                    </description>
                    <substitute>_SRCPORT_</substitute>
            	</tag>
            	<tag name="logon_process" tagType="Anything">
                    <description>
                        <localized_desc language="en">The logon pricess name</localized_desc>
                        <localized_desc language="fr">Le nom de programme de connexion</localized_desc>
                    </description>
                    <substitute>_LPROCESS_</substitute>
            	</tag>
            	<tag name="authentification_package" tagType="Anything">
                    <description>
                        <localized_desc language="en">The authentication package</localized_desc>
                        <localized_desc language="fr">Le package d'authentification</localized_desc>
                    </description>
                    <substitute>_AP_</substitute>
            	</tag> 
            	<tag name="transited_services" tagType="Anything">
                    <description>
                        <localized_desc language="en">The transited services</localized_desc>
                        <localized_desc language="fr">Les services en transit</localized_desc>
                    </description>
                    <substitute>_TS_</substitute>
            	</tag>
            	<tag name="package_name" tagType="Anything">
                    <description>
                        <localized_desc language="en">The package name</localized_desc>
                        <localized_desc language="fr">Le nom du package</localized_desc>
                    </description>
                    <substitute>_PN_</substitute>
            	</tag> 
            	<tag name="key_length" tagType="Anything">
                    <description>
                        <localized_desc language="en">The key length</localized_desc>
                        <localized_desc language="fr">La taille de la clé</localized_desc>
                    </description>
                    <substitute>_KL_</substitute>
            	</tag>
            </tags>
            <commonTags>
            	<commonTag name="status">success</commonTag>
            </commonTags>
            <examples>
                <example>
                     <text>An account was successfully logged on.

Subject:
   Security ID:  SYSTEM
   Account Name:  WIN-R9H529RIO4Y$
   Account Domain:  WORKGROUP
   Logon ID:  0x3e7
Logon Type: 10
New Logon:
      Security ID:  WIN-R9H529RIO4Y\Administrator
   Account Name:  Administrator
   Account Domain:  WIN-R9H529RIO4Y
   Logon ID:  0x19f4c
   Logon GUID:  {00000000-0000-0000-0000-000000000000}
Process Information:
   Process ID:  0x4c0
   Process Name:  C:\Windows\System32\winlogon.exe
Network Information:
   Workstation Name: WIN-R9H529RIO4Y
   Source Network Address: 10.42.42.211
   Source Port:  1181
Detailed Authentication Information:
   Logon Process:  User32 
   Authentication Package: Negotiate
   Transited Services: -
   Package Name (NTLM only): -
   Key Length:  0
   
 This event is generated when a logon session is created. 
 It is generated on the computer that was accessed. 
 The subject fields indicate the account on the local system which requested the logon. 
 This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe. 
 The logon type field indicates the kind of logon that occurred. 
 The most common types are 2 (interactive) and 3 (network). 
 The New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on. 
 The network fields indicate where a remote logon request originated. 
 Workstation name is not always available and may be left blank in some cases. 
 The authentication information fields provide detailed information about this specific logon request. 
 
 - Logon GUID is a unique identifier that can be used to correlate this event with a KDC event. 
 - Transited services indicate which intermediate services have participated in this logon request. 
 - Package name indicates which sub-protocol was used among the NTLM protocols. 
 - Key length indicates the length of the generated session key. This will be 0 if no session key was requested.</text>
                     <expectedTags>
                          <expectedTag name="security_id">SYSTEM</expectedTag>
                          <expectedTag name="account_name">WIN-R9H529RIO4Y$</expectedTag>
                          <expectedTag name="account_domaine">WORKGROUP</expectedTag>
                          <expectedTag name="logon_id">0x3e7</expectedTag>
                          <expectedTag name="logon_type">10</expectedTag>
                          <expectedTag name="method">RemoteInteractive</expectedTag>
                          <expectedTag name="new_logon_security_id">WIN-R9H529RIO4Y\Administrator</expectedTag>
                          <expectedTag name="new_logon_account_name">Administrator</expectedTag>
                          <expectedTag name="new_logon_account_domain">WIN-R9H529RIO4Y</expectedTag>
                          <expectedTag name="new_logon_id">0x19f4c</expectedTag>
                          <expectedTag name="new_logon_guid">{00000000-0000-0000-0000-000000000000}</expectedTag>
                          <expectedTag name="pid">0x4c0</expectedTag>
                          <expectedTag name="process_name">C:\Windows\System32\winlogon.exe</expectedTag>
                          <expectedTag name="workstation_name">WIN-R9H529RIO4Y</expectedTag>
                          <expectedTag name="source_ip">10.42.42.211</expectedTag>
                          <expectedTag name="source_port">1181</expectedTag>
                          <expectedTag name="logon_process">User32</expectedTag>
                          <expectedTag name="authentification_package">Negotiate</expectedTag>
                          <expectedTag name="transited_services">-</expectedTag>
                          <expectedTag name="package_name">-</expectedTag>
                          <expectedTag name="key_length">0</expectedTag>
                          <expectedTag name="status">success</expectedTag>
                     </expectedTags>
                </example>
            </examples>
	</pattern><pattern name="eventID-4625">
            <description>
                <localized_desc language="en">Logon failure</localized_desc>
                <localized_desc language="fr">Echec de la connexion</localized_desc>
            </description>            
            <text>An account failed to log on. Subject: Security ID: _SID_ Account Name: _ACCOUNTNAME_ Account Domain: _ACCOUNTDOMAIN_ Logon ID:  _LID_ Logon Type: _LOGONTYPE_ Account For Which Logon Failed: Security ID: _FSID_ Account Name: _FACCN_ Account Domain: _FACCD_ Failure Information: Failure Reason:  _FREASON_ Status: _FSTATUS_ Sub Status: _FSUBSTATUS_ Process Information: Caller Process ID: _CPID_ Caller Process Name: _CPN_ Network Information: Workstation Name:  _WORKSTATIONNAME_ Source Network Address: _SRCNETWORKADDR_ Source Port:  _SRCPORT_ Detailed Authentication Information: Logon Process:  _LPROCESS_  Authentication Package: _AP_ Transited Services: _TS_ Package Name \(NTLM only\): _PN_  Key Length:  _KL_  This event is generated when a logon request fails. It is generated on the computer where access was attempted. The Subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe. The Logon Type field indicates the kind of logon that was requested. The most common types are 2 \(interactive\) and 3 \(network\). The Process Information fields indicate which account and process on the system requested the logon. The Network Information fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases. The authentication information fields provide detailed information about this specific logon request. - Transited services indicate which intermediate services have participated in this logon request. - Package name indicates which sub-protocol was used among the NTLM protocols. - Key length indicates the length of the generated session key. This will be 0 if no session key was requested</text>
            <tags>
            	<tag name="security_id" tagType="Anything">
                    <description>
                        <localized_desc language="en">The security ID</localized_desc>
                        <localized_desc language="fr">L'identifiant de sécurité</localized_desc>
                    </description>
                    <substitute>_SID_</substitute>
            	</tag>
            	<tag name="account_name" tagType="Anything">
                    <description>
                        <localized_desc language="en">Identifies the account that requested the logon - NOT the user who just logged on</localized_desc>
                        <localized_desc language="fr">Identifie le nom du compte qui a fait la requête de connexion - Pas l'utilisateur qui est déjà connecté</localized_desc>
                    </description>
                    <substitute>_ACCOUNTNAME_</substitute>
            	</tag>
            	<tag name="account_domaine" tagType="Anything">
                    <description>
                        <localized_desc language="en">Identifies the domaine of the account that requested the logon - NOT the user who just logged on</localized_desc>
                        <localized_desc language="fr">Identifie le domaine du compte qui a fait la requête de connexion - Pas l'utilisateur qui est déjà connecté</localized_desc>
                    </description>
                    <substitute>_ACCOUNTDOMAIN_</substitute>
            	</tag>
            	<tag name="logon_id" tagType="Anything">
                    <description>
                        <localized_desc language="en">The account ID that requested the logon - NOT the user who just logged on</localized_desc>
                        <localized_desc language="fr">L'identifiant de connexion du compte qui a fait la requête de connexion - Pas l'utilisateur qui est déjà connecté </localized_desc>
                    </description>
                    <substitute>_LID_</substitute>
            	</tag>
            	<tag name="logon_type" tagType="Integer">
                    <description>
                        <localized_desc language="en">The logon type</localized_desc>
                        <localized_desc language="fr">Le type de connexion</localized_desc>
                    </description>
                    <substitute>_LOGONTYPE_</substitute>
                    <callbacks>
                 		<callback>decode_logon_type</callback>
                 	</callbacks>
            	</tag>
            	<tag name="failed_security_id" tagType="Anything">
                    <description>
                        <localized_desc language="en">The account security ID for which Llogon failed</localized_desc>
                        <localized_desc language="fr">L'identifiant de securité du compte pour lequel la connexion a échoué</localized_desc>
                    </description>
                    <substitute>_FSID_</substitute>
            	</tag>            	
            	<tag name="failed_account_name" tagType="Anything">
                    <description>
                        <localized_desc language="en">The account name for which logon failed</localized_desc>
                        <localized_desc language="fr">Le nom du compte pour lequel la connexion a échoué</localized_desc>
                    </description>
                    <substitute>_FACCN_</substitute>
            	</tag>
            	<tag name="failed_account_domain" tagType="Anything">
                    <description>
                        <localized_desc language="en">The account domaine for which logon failed</localized_desc>
                        <localized_desc language="fr">Le domaine du compte pour lequel la connexion a échoué</localized_desc>
                    </description>
                    <substitute>_FACCD_</substitute>
            	</tag> 
            	
            	
            	<tag name="failure_reason" tagType="Anything">
                    <description>
                        <localized_desc language="en">The failure reason</localized_desc>
                        <localized_desc language="fr">La raison de l'échec</localized_desc>
                    </description>
                    <substitute>_FREASON_</substitute>
            	</tag> 
            	<tag name="failure_status" tagType="Anything">
                    <description>
                        <localized_desc language="en">The failure status</localized_desc>
                        <localized_desc language="fr">Le status de l'échec de connexion</localized_desc>
                    </description>
                    <substitute>_FSTATUS_</substitute>
            	</tag>
            	<tag name="failure_sub_status" tagType="Anything">
                    <description>
                        <localized_desc language="en">The failure sub_status"</localized_desc>
                        <localized_desc language="fr">Le sous-status de l'échec de connexion</localized_desc>
                    </description>
                    <substitute>_FSUBSTATUS_</substitute>
            	</tag>
            	
            	<tag name="caller_pid" tagType="Anything">
                    <description>
                        <localized_desc language="en">The caller process ID</localized_desc>
                        <localized_desc language="fr">L'identifiant de processus de l'appelant</localized_desc>
                    </description>
                    <substitute>_CPID_</substitute>
            	</tag>
            	
            	<tag name="caller_process_name" tagType="Anything">
                    <description>
                        <localized_desc language="en">The caller process name</localized_desc>
                        <localized_desc language="fr">Le nom du processus de l'appelant</localized_desc>
                    </description>
                    <substitute>_CPN_</substitute>
            	</tag> 
				<tag name="workstation_name" tagType="Anything">
                    <description>
                        <localized_desc language="en">The workstation name</localized_desc>
                        <localized_desc language="fr">Le nom du poste de travail</localized_desc>
                    </description>
                    <substitute>_WORKSTATIONNAME_</substitute>
            	</tag> 
				<tag name="source_ip" tagType="Anything">
                    <description>
                        <localized_desc language="en">The logon source IP</localized_desc>
                        <localized_desc language="fr">L'IP source de la connexion</localized_desc>
                    </description>
                    <substitute>_SRCNETWORKADDR_</substitute>
            	</tag>
            	<tag name="source_port" tagType="Anything">
                    <description>
                        <localized_desc language="en">The logon source port</localized_desc>
                        <localized_desc language="fr">Le port source de la connexion</localized_desc>
                    </description>
                    <substitute>_SRCPORT_</substitute>
            	</tag>
            	<tag name="logon_process" tagType="Anything">
                    <description>
                        <localized_desc language="en">The logon process name</localized_desc>
                        <localized_desc language="fr">Le nom de programme de connexion</localized_desc>
                    </description>
              		<substitute>_LPROCESS_</substitute>
            	</tag>
              	
              	<tag name="logon_type" tagType="Integer">
                    <description>
                        <localized_desc language="en">The logon type</localized_desc>
                        <localized_desc language="fr">Le type de connexion</localized_desc>
                    </description>
                    <substitute>_LOGONTYPE_</substitute>
                    <callbacks>
                 		<callback>decode_logon_type</callback>
                 	</callbacks>
            	</tag>
                    
            	<tag name="authentification_package" tagType="Anything">
                    <description>
                        <localized_desc language="en">The authentication package</localized_desc>
                        <localized_desc language="fr">Le package d'authentification</localized_desc>
                    </description>
                    <substitute>_AP_</substitute>
            	</tag> 
            	<tag name="transited_services" tagType="Anything">
                    <description>
                        <localized_desc language="en">The transited services</localized_desc>
                        <localized_desc language="fr">Les services en transit</localized_desc>
                    </description>
                    <substitute>_TS_</substitute>
            	</tag>
            	<tag name="package_name" tagType="Anything">
                    <description>
                        <localized_desc language="en">The package name</localized_desc>
                        <localized_desc language="fr">Le nom du package</localized_desc>
                    </description>
                    <substitute>_PN_</substitute>
            	</tag> 
            	<tag name="key_length" tagType="Anything">
                    <description>
                        <localized_desc language="en">The key length</localized_desc>
                        <localized_desc language="fr">La taille de la clé</localized_desc>
                    </description>
                    <substitute>_KL_</substitute>
            	</tag>
            </tags>
            <commonTags>
            	<commonTag name="status">failure</commonTag>
            </commonTags>
            <examples>
                <example>
                     <text>An account failed to log on.

Subject:
   Security ID:  NULL SID
   Account Name:  -
   Account Domain:  -
   Logon ID:  0x0
Logon Type:  3
Account For Which Logon Failed:
   Security ID:  NULL SID
   Account Name:  asdf
   Account Domain: - 
Failure Information:
   Failure Reason:  Unknown user name or bad password.
   Status:   0xc000006d
   Sub Status:  0xc0000064
Process Information:
   Caller Process ID: 0x0
   Caller Process Name: -
Network Information:
   Workstation Name: WIN-R9H529RIO4Y
   Source Network Address: 10.42.42.201
   Source Port:  53176
Detailed Authentication Information:
      Logon Process:  NtLmSsp 
   Authentication Package: NTLM
   Transited Services: -
   Package Name (NTLM only): -
   Key Length:  0
 
 This event is generated when a logon request fails. 
 It is generated on the computer where access was attempted. 
 The Subject fields indicate the account on the local system which requested the logon. 
 This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe. 
 The Logon Type field indicates the kind of logon that was requested. 
 The most common types are 2 (interactive) and 3 (network). 
 The Process Information fields indicate which account and process on the system requested the logon. 
 The Network Information fields indicate where a remote logon request originated. 
 Workstation name is not always available and may be left blank in some cases. 
 The authentication information fields provide detailed information about this specific logon request. 
 
 - Transited services indicate which intermediate services have participated in this logon request. 
 - Package name indicates which sub-protocol was used among the NTLM protocols. 
 - Key length indicates the length of the generated session key. This will be 0 if no session key was requested.</text>
                     <expectedTags>
                          <expectedTag name="security_id">NULL SID</expectedTag>
                          <expectedTag name="account_name">-</expectedTag>
                          <expectedTag name="account_domaine">-</expectedTag>
                          <expectedTag name="logon_id">0x0</expectedTag>
                          <expectedTag name="logon_type">3</expectedTag>
                          <expectedTag name="method">Network</expectedTag>                   
                          <expectedTag name="failed_security_id">NULL SID</expectedTag>
                          <expectedTag name="failed_account_name">asdf</expectedTag>
                          <expectedTag name="failed_account_domain">-</expectedTag>
                          <expectedTag name="failure_reason">Unknown user name or bad password.</expectedTag>
                          <expectedTag name="failure_status">0xc000006d</expectedTag>
                          <expectedTag name="failure_sub_status">0xc0000064</expectedTag>
                          <expectedTag name="caller_pid">0x0</expectedTag>
                          <expectedTag name="caller_process_name">-</expectedTag>
                          <expectedTag name="workstation_name">WIN-R9H529RIO4Y</expectedTag>
                          <expectedTag name="source_ip">10.42.42.201</expectedTag>
                          <expectedTag name="source_port">53176</expectedTag>
                          <expectedTag name="logon_process">NtLmSsp</expectedTag>
                          <expectedTag name="authentification_package">NTLM</expectedTag>
                          <expectedTag name="transited_services">-</expectedTag>
                          <expectedTag name="package_name">-</expectedTag>
                          <expectedTag name="key_length">0</expectedTag>
                          <expectedTag name="status">failure</expectedTag>
                     </expectedTags>
                </example>
            </examples>
		</pattern><pattern name="eventID-4634">
			<description>
                <localized_desc language="en">User Logoff</localized_desc>
                <localized_desc language="fr">Déconnexion utilisateur</localized_desc>
            </description>
			<text>An account was logged off. Subject:	Security ID:  _SID_	Account Name: _ACCOUNTNAME_ Account Domain: _ACCOUNTDOMAIN_   Logon ID:  _LID_ Logon Type: _LOGONTYPE_ This event is generated when a logon session is destroyed. It may be positively correlated with a logon event using the Logon ID value. Logon IDs are only unique between reboots on the same computer.</text>
			<tags>
				<tag name="security_id" tagType="Anything">
                    <description>
                        <localized_desc language="en">The security ID</localized_desc>
                        <localized_desc language="fr">L'identifiant de sécurité</localized_desc>
                    </description>
                    <substitute>_SID_</substitute>
            	</tag>
            	<tag name="account_name" tagType="Anything">
                    <description>
                        <localized_desc language="en">Identifies the account that requested the logon</localized_desc>
                        <localized_desc language="fr">Identifie le nom du compte qui a fait la requête de connexion</localized_desc>
                    </description>
                    <substitute>_ACCOUNTNAME_</substitute>
            	</tag>
            	<tag name="account_domaine" tagType="Anything">
                    <description>
                        <localized_desc language="en">Identifies the domaine of the account that requested the logon</localized_desc>
                        <localized_desc language="fr">Identifie le domaine du compte qui a fait la requête de connexion</localized_desc>
                    </description>
                    <substitute>_ACCOUNTDOMAIN_</substitute>
            	</tag>
            	<tag name="logon_id" tagType="Anything">
                    <description>
                        <localized_desc language="en">The account ID that requested the logon</localized_desc>
                        <localized_desc language="fr">L'identifiant de connexion du compte qui a fait la requête de connexion</localized_desc>
                    </description>
                    <substitute>_LID_</substitute>
            	</tag>
            	<tag name="logon_type" tagType="Integer">
                    <description>
                        <localized_desc language="en">The logon type</localized_desc>
                        <localized_desc language="fr">Le type de connexion</localized_desc>
                    </description>
                    <substitute>_LOGONTYPE_</substitute>
                    <callbacks>
                 		<callback>decode_logon_type</callback>
                 	</callbacks>
            	</tag>
			</tags>
			<examples>
				<example>
					<text>An account was logged off.

Subject:
   Security ID:  ANONYMOUS LOGON
   Account Name:  ANONYMOUS LOGON
   Account Domain:  NT AUTHORITY   
   Logon ID:  0x149be
Logon Type: 3

This event is generated when a logon session is destroyed. 
It may be positively correlated with a logon event using the Logon ID value. 
Logon IDs are only unique between reboots on the same computer.</text>
					<expectedTags>
						<expectedTag name="security_id">ANONYMOUS LOGON</expectedTag>
						<expectedTag name="account_name">ANONYMOUS LOGON</expectedTag>
						<expectedTag name="account_domaine">NT AUTHORITY</expectedTag>
						<expectedTag name="logon_id">0x149be</expectedTag>
						<expectedTag name="logon_type">3</expectedTag>
					</expectedTags>
				</example>
			</examples>
		</pattern><pattern name="eventID-4647">
			<description>
				<localized_desc language="en">User initiated logoff</localized_desc>
				<localized_desc language="fr">L'utilisateur a initié une déconnexion</localized_desc>
			</description>
			<text>User initiated logoff: Subject: Security ID: _SID_ Account Name: _ACCOUNTNAME_ Account Domain: _ACCOUNTDOMAIN_ Logon ID: _LID_ This event is generated when a logoff is initiated.? (?:but the token reference count is not zero and the logon session cannot be destroyed. )?No further user-initiated activity can occur.  This event can be interpreted as a logoff event.</text>
			<tags>
				<tag name="security_id" tagType="Anything">
                    <description>
                        <localized_desc language="en">The security ID</localized_desc>
                        <localized_desc language="fr">L'identifiant de sécurité</localized_desc>
                    </description>
                    <substitute>_SID_</substitute>
            	</tag>
            	<tag name="account_name" tagType="Anything">
                    <description>
                        <localized_desc language="en">Identifies the account that requested the logon</localized_desc>
                        <localized_desc language="fr">Identifie le nom du compte qui a fait la requête de connexion</localized_desc>
                    </description>
                    <substitute>_ACCOUNTNAME_</substitute>
            	</tag>
            	<tag name="account_domaine" tagType="Anything">
                    <description>
                        <localized_desc language="en">Identifies the domaine of the account that requested the logon</localized_desc>
                        <localized_desc language="fr">Identifie le domaine du compte qui a fait la requête de connexion</localized_desc>
                    </description>
                    <substitute>_ACCOUNTDOMAIN_</substitute>
            	</tag>
            	<tag name="logon_id" tagType="Anything">
                    <description>
                        <localized_desc language="en">The account ID that requested the logon</localized_desc>
                        <localized_desc language="fr">L'identifiant de connexion du compte qui a fait la requête de connexion</localized_desc>
                    </description>
                    <substitute>_LID_</substitute>
            	</tag>
			</tags>
			<examples>
				<example>
					<text>User initiated logoff:

Subject:
   Security ID:  WIN-R9H529RIO4Y\Administrator
   Account Name:  Administrator
   Account Domain:  WIN-R9H529RIO4Y
   Logon ID:  0x19f4c

This event is generated when a logoff is initiated but the token reference count 
is not zero and the logon session cannot be destroyed.  
No further user-initiated activity can occur.  
This event can be interpreted as a logoff event.</text>
					<expectedTags>
						<expectedTag name="security_id">WIN-R9H529RIO4Y\Administrator</expectedTag>
						<expectedTag name="account_name">Administrator</expectedTag>
						<expectedTag name="account_domaine">WIN-R9H529RIO4Y</expectedTag>
						<expectedTag name="logon_id">0x19f4c</expectedTag>
					</expectedTags>
				</example>
				<example>
					<text>User initiated logoff: 
					
Subject: 
	Security ID: S-1-5-21-2218251928-2375033965-419438225-500 
	Account Name: Administrator 
	Account Domain: WIN-D7NM05T4KNM 
	Logon ID: 0xa2a99 
	
This event is generated when a logoff is initiated. 
No further user-initiated activity can occur. 
This event can be interpreted as a logoff event.</text>
					<expectedTags>
						<expectedTag name="security_id">S-1-5-21-2218251928-2375033965-419438225-500</expectedTag>
						<expectedTag name="account_name">Administrator</expectedTag>
						<expectedTag name="account_domaine">WIN-D7NM05T4KNM</expectedTag>
						<expectedTag name="logon_id">0xa2a99</expectedTag>
					</expectedTags>
				</example>
			</examples>
		</pattern><pattern name="eventID-4648">
            <description>
                <localized_desc language="en">Logon failure</localized_desc>
                <localized_desc language="fr">Echec de la connexion</localized_desc>
            </description>            
            
            <text>A logon was attempted using explicit credentials.	Subject: Security ID: _SID_ Account Name: _ACCOUNTNAME_ Account Domain: _ACCOUNTDOMAIN_ Logon ID: _LID_ Logon GUID: _LGUID_ Account Whose Credentials Were Used: Account Name:  _CACCOUNTNAME_ Account Domain:  _CACCOUNTDOMAINE_ Logon GUID:  _CLOGUID_ Target Server: Target Server Name: _TSERVERNAME_ Additional Information: (?:_ADDINFO_ )?Process Information: Process ID: _PID_ Process Name: _PNAME_ Network Information: Network Address: _NETWORKADDR_ Port: _PORT_  This event is generated when a process attempts to log on an account by explicitly specifying that account\'s credentials.  This most commonly occurs in batch-type configurations such as scheduled tasks, or when using the RUNAS command.</text>
            <tags>
            	<tag name="security_id" tagType="Anything">
                    <description>
                        <localized_desc language="en">The security ID</localized_desc>
                        <localized_desc language="fr">L'identifiant de sécurité</localized_desc>
                    </description>
                    <substitute>_SID_</substitute>
            	</tag>
            	<tag name="account_name" tagType="Anything">
                    <description>
                        <localized_desc language="en">Identifies the account that requested the logon</localized_desc>
                        <localized_desc language="fr">Identifie le nom du compte qui a fait la requête de connexion</localized_desc>
                    </description>
                    <substitute>_ACCOUNTNAME_</substitute>
            	</tag>
            	<tag name="account_domaine" tagType="Anything">
                    <description>
                        <localized_desc language="en">Identifies the domaine of the account that requested the logon</localized_desc>
                        <localized_desc language="fr">Identifie le domaine du compte qui a fait la requête de connexion</localized_desc>
                    </description>
                    <substitute>_ACCOUNTDOMAIN_</substitute>
            	</tag>
            	<tag name="logon_id" tagType="Anything">
                    <description>
                        <localized_desc language="en">The account ID that requested the logon</localized_desc>
                        <localized_desc language="fr">L'identifiant de connexion du compte qui a fait la requête de connexion</localized_desc>
                    </description>
                    <substitute>_LID_</substitute>
            	</tag>
            	<tag name="logon_guid" tagType="Anything">
                    <description>
                        <localized_desc language="en">The account GUID that requested the logon - NOT the user who just logged on</localized_desc>
                        <localized_desc language="fr">L'identifiant GUID de connexion du compte qui a fait la requête de connexion</localized_desc>
                    </description>
                    <substitute>_LGUID_</substitute>
            	</tag>
            	<tag name="credentials_account_name" tagType="Anything">
                    <description>
                        <localized_desc language="en">The Account name whose credentials were used</localized_desc>
                        <localized_desc language="fr">Le nom du compte dont les informations d'identification de connexion ont été utilisés</localized_desc>
                    </description>
                    <substitute>_CACCOUNTNAME_</substitute>
            	</tag>
            	<tag name="credentials_account_domain" tagType="Anything">
                    <description>
                        <localized_desc language="en">The account domaine whose credentials were used</localized_desc>
                        <localized_desc language="fr">Le domaine du compte dont les informations d'identification de connexion ont été utilisés</localized_desc>
                    </description>
                    <substitute>_CACCOUNTDOMAINE_</substitute>
            	</tag> 
            	<tag name="credentials_logon_guid" tagType="Anything">
                    <description>
                        <localized_desc language="en">The credentials logon GUID</localized_desc>
                        <localized_desc language="fr">L'identifiant GUID du compte dont les informations d'identification de connexion ont été utilisés</localized_desc>
                    </description>
                    <substitute>_CLOGUID_</substitute>
            	</tag> 
            	<tag name="target_server_name" tagType="Anything">
                    <description>
                        <localized_desc language="en">The target server name</localized_desc>
                        <localized_desc language="fr">Le nom du serveur cible</localized_desc>
                    </description>
                    <substitute>_TSERVERNAME_</substitute>
            	</tag>
            	<tag name="additional_information" tagType="Anything">
                    <description>
                        <localized_desc language="en">Addictional information</localized_desc>
                        <localized_desc language="fr">Information supplémentaire</localized_desc>
                    </description>
                    <substitute>_ADDINFO_</substitute>
            	</tag>
            	<tag name="pid" tagType="Anything">
                    <description>
                        <localized_desc language="en">The  process ID</localized_desc>
                        <localized_desc language="fr">L'identifiant du processus</localized_desc>
                    </description>
                    <substitute>_PID_</substitute>
            	</tag>
            	<tag name="process_name" tagType="Anything">
                    <description>
                        <localized_desc language="en">The  process name</localized_desc>
                        <localized_desc language="fr">Le nom du processus</localized_desc>
                    </description>
                    <substitute>_PNAME_</substitute>
            	</tag>
            	 
				<tag name="address" tagType="Anything">
                    <description>
                        <localized_desc language="en">The logon source address</localized_desc>
                        <localized_desc language="fr">L'adresse de connexion</localized_desc>
                    </description>
                    <substitute>_NETWORKADDR_</substitute>
            	</tag> 
				<tag name="port" tagType="Anything">
                    <description>
                        <localized_desc language="en">The logon source port</localized_desc>
                        <localized_desc language="fr">Le port de connexion</localized_desc>
                    </description>
                    <substitute>_PORT_</substitute>
            	</tag>
            </tags>
            <commonTags>
            	<commonTag name="status">failure</commonTag>
            </commonTags>
            <examples>
                <example>
                     <text>A logon was attempted using explicit credentials.

Subject:
   Security ID:  WIN-R9H529RIO4Y\Administrator
   Account Name:  Administrator
   Account Domain:  WIN-R9H529RIO4Y
   Logon ID:  0x1ba0e
   Logon GUID:  {00000000-0000-0000-0000-000000000000}
Account Whose Credentials Were Used:
   Account Name:  rsmith@mtg.com
   Account Domain:  WIN-R9H529RIO4Y
   Logon GUID:  {00000000-0000-0000-0000-000000000000}
Target Server:
   Target Server Name: sp01.IceMAIL.com
   Additional Information: sp01.IceMAIL.com
Process Information:
   Process ID:  0x77c
   Process Name:  C:\Program Files\Internet Explorer\iexplore.exe
Network Information:
   Network Address: -
   Port:   -
   
This event is generated when a process attempts 
to log on an account by explicitly specifying that account's credentials.  
This most commonly occurs in batch-type configurations such as scheduled tasks, 
or when using the RUNAS command.</text>
                     <expectedTags>
                          <expectedTag name="security_id">WIN-R9H529RIO4Y\Administrator</expectedTag>
                          <expectedTag name="account_name">Administrator</expectedTag>
                          <expectedTag name="account_domaine">WIN-R9H529RIO4Y</expectedTag>
                          <expectedTag name="logon_id">0x1ba0e</expectedTag>
                          <expectedTag name="logon_guid">{00000000-0000-0000-0000-000000000000}</expectedTag>
                          <expectedTag name="credentials_account_name">rsmith@mtg.com</expectedTag>                   
                          <expectedTag name="credentials_account_domain">WIN-R9H529RIO4Y</expectedTag>
                          <expectedTag name="credentials_logon_guid">{00000000-0000-0000-0000-000000000000}</expectedTag>
                          <expectedTag name="target_server_name">sp01.IceMAIL.com</expectedTag>
                          <expectedTag name="additional_information">sp01.IceMAIL.com</expectedTag>
                          <expectedTag name="pid">0x77c</expectedTag>
                          <expectedTag name="process_name">C:\Program Files\Internet Explorer\iexplore.exe</expectedTag>
                          <expectedTag name="address">-</expectedTag>
                          <expectedTag name="port">-</expectedTag>
                          <expectedTag name="status">failure</expectedTag>
                     </expectedTags>
                </example>
                <example>
                	<text>A logon was attempted using explicit credentials. 
               	
Subject: 
   Security ID: S-1-5-18 
   Account Name: WIN-D7NM05T4KNM$ 
   Account Domain: WORKGROUP 
   Logon ID: 0x3e7 
   Logon GUID: {00000000-0000-0000-0000-000000000000} 
Account Whose Credentials Were Used: 
   Account Name: Administrator 
   Account Domain: WIN-D7NM05T4KNM 
   Logon GUID: {00000000-0000-0000-0000-000000000000} 
Target Server: 
   Target Server Name: localhost 
   Additional Information: localhost
Process Information: 
   Process ID: 0x5e0 
   Process Name: C:\Windows\System32\winlogon.exe 
Network Information: 
   Network Address: 127.0.0.1 
   Port: 0 
         		
This event is generated when a process attempts 
to log on an account by explicitly specifying that account's credentials. 
This most commonly occurs in batch-type configurations such as scheduled tasks, 
or when using the RUNAS command.</text>
                	<expectedTags>
	                	  <expectedTag name="security_id">S-1-5-18</expectedTag>
                          <expectedTag name="account_name">WIN-D7NM05T4KNM$</expectedTag>
                          <expectedTag name="account_domaine">WORKGROUP</expectedTag>
                          <expectedTag name="logon_id">0x3e7</expectedTag>
                          <expectedTag name="logon_guid">{00000000-0000-0000-0000-000000000000}</expectedTag>
                          <expectedTag name="credentials_account_name">Administrator</expectedTag>                   
                          <expectedTag name="credentials_account_domain">WIN-D7NM05T4KNM</expectedTag>
                          <expectedTag name="credentials_logon_guid">{00000000-0000-0000-0000-000000000000}</expectedTag>
                          <expectedTag name="target_server_name">localhost</expectedTag>
                          <expectedTag name="additional_information">localhost</expectedTag>
                          <expectedTag name="pid">0x5e0</expectedTag>
                          <expectedTag name="process_name">C:\Windows\System32\winlogon.exe</expectedTag>
                          <expectedTag name="address">127.0.0.1</expectedTag>
                          <expectedTag name="port">0</expectedTag>
                	</expectedTags>
                </example>
            </examples>
		</pattern>
    </patterns>
    <finalCallbacks>
    	<callback>strip_values</callback>
    </finalCallbacks>
</normalizer>
